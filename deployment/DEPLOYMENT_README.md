# üöÄ CloverdashBot - Production Deployment

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–µ–∫–∞ CloverdashBot (Backend API + Telegram Bot) –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üöÄ **–ü–æ–ª–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π** - –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç –≤–µ—Å—å —Å—Ç–µ–∫
- üê≥ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker/docker-compose
- üîß **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏  
- üéØ **–°–µ–ª–µ–∫—Ç–∏–≤–Ω—ã–π –¥–µ–ø–ª–æ–π** - –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ backend –∏–ª–∏ —Ç–æ–ª—å–∫–æ bot
- üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ SSH –∫–ª—é—á–µ–π –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üìä **Health checks** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- üßπ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞** - —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –æ–±—Ä–∞–∑–æ–≤ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- üìù **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Docker** - –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Docker —É—Å—Ç–∞–Ω–æ–≤–∫–∏

## üéØ –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
cp deploy.env.example deploy.env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ deploy.env –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã
nano deploy.env
```

### 2. –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

#### –ü–æ–ª–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Backend + Bot):
```bash
./deploy_all.sh
```

#### –¢–æ–ª—å–∫–æ Backend API:
```bash
./deploy_all.sh --backend-only
```

#### –¢–æ–ª—å–∫–æ Telegram Bot:
```bash
./deploy_all.sh --bot-only
```

#### –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
```bash
./deploy_all.sh -h your-server.com -u ubuntu -k ~/.ssh/custom_key
```

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Docker —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker/docker-compose –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
./test_docker_installation.sh

# –° custom –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
./test_docker_installation.sh -h your-server.com -u ubuntu
```

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### üîß Backend API (`backend/`)
- **FastAPI** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- **PostgreSQL** –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –¥–≤—É–º –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö:
  - App Database (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
  - Data Database (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤)
- **OpenAI API** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- **JWT Authentication** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Health checks** –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–ü–æ—Ä—Ç**: 8000

### ü§ñ Telegram Bot (`telegram-bot/`)
- **Python Telegram Bot** (python-telegram-bot)
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Backend API** —á–µ—Ä–µ–∑ localhost:8000
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ Telegram
- **–ö–æ–º–∞–Ω–¥—ã**: /start, /help, /tables, /sample
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤** –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** –ø—Ä–∏ —Å–±–æ—è—Ö

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
- ‚úÖ SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –∫–ª—é—á–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `id_ed25519_do_cloverdash-bot`)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ–∞–π–ª `deploy.env` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ `.env` —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–∞—Ö `backend/` –∏ `telegram-bot/`

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
- ‚úÖ Ubuntu/Debian Linux
- ‚úÖ PostgreSQL —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–¥–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 8000 –¥–ª—è API
- ‚úÖ Docker –∏ Docker Compose (–±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- ‚úÖ `deploy.env` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (—Å–µ—Ä–≤–µ—Ä, –∫–ª—é—á–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- ‚úÖ `backend/.env` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è backend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ `telegram-bot/.env` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Telegram –±–æ—Ç–∞

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Deployment Config (`deploy.env`):
```env
# Server Configuration
REMOTE_HOST=64.227.69.138
REMOTE_USER=root
SSH_KEY_PATH=~/.ssh/id_ed25519_do_cloverdash-bot

# Deployment Options
DEPLOY_BACKEND=true
DEPLOY_BOT=true

# Optional: Custom deployment directory on server
REMOTE_DEPLOY_DIR=/opt/cloverdash-bot

# Optional: Docker Registry (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä)
# DOCKER_REGISTRY=your-registry.com
# DOCKER_USERNAME=your-username
# DOCKER_PASSWORD=your-password
```

### Backend (.env –≤ `backend/`):
```env
# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_TEMPERATURE=0

# Application Database Configuration (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∏—Å—Ç–æ—Ä–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
APP_DATABASE_URL=postgresql://app_user:app_password@localhost:5432/cloverdash_app
# –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ:
APP_DATABASE_HOST=64.227.69.138  # –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ localhost –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
APP_DATABASE_PORT=5432
APP_DATABASE_USER=app_user
APP_DATABASE_PASSWORD=app_password
APP_DATABASE_NAME=cloverdash_app

# Data Database Configuration (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤)
DATA_DATABASE_URL=postgresql://data_user:data_password@localhost:5433/cloverdash_data
# –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ:
DATA_DATABASE_HOST=64.227.69.138  # –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ localhost –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
DATA_DATABASE_PORT=5433
DATA_DATABASE_USER=data_user
DATA_DATABASE_PASSWORD=data_password
DATA_DATABASE_NAME=cloverdash_data

# Security (–±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –Ω–æ–≤—ã–π –∫–ª—é—á)
SECRET_KEY=your-secret-key-here-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=43200

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
ALLOWED_ORIGINS=["*"]
LOG_LEVEL=INFO
```

### Bot (.env –≤ `telegram-bot/`):
```env
# Bot Token (–ø–æ–ª—É—á–∏—Ç—å –æ—Ç @BotFather –≤ Telegram)
TELEGRAM_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# API URL (–±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ localhost –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏)
BACKEND_URL=http://64.227.69.138:8000
```

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:
```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
cp deploy.env.example deploy.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ deploy.env —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
cp backend/env_example.txt backend/.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ backend/.env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

# 3. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª –¥–ª—è –±–æ—Ç–∞
echo "TELEGRAM_TOKEN=your_bot_token_here" > telegram-bot/.env
echo "BACKEND_URL=http://your-server-ip:8000" >> telegram-bot/.env
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ `deploy.env`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –∫–ª—é—á–æ–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (backend/.env, telegram-bot/.env)
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π
- ‚úÖ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker/Docker Compose (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ SECRET_KEY –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- ‚úÖ Health checks –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ Backend API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000
- ‚úÖ Telegram Bot –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### API:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}

# Health check
curl http://$REMOTE_HOST:8000/api/v1/health

# API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
open http://$REMOTE_HOST:8000/docs
```

### Bot:
1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram –ø–æ username
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
   - `/help` - —Å–ø—Ä–∞–≤–∫–∞
   - `/tables` - —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
   - `/sample table_name` - –ø—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
   - –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ

### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}
REMOTE_DEPLOY_DIR=${REMOTE_DEPLOY_DIR:-/opt/cloverdash-bot}

ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR && find . -name 'docker-compose*.yml' -exec docker-compose -f {} ps \\;"
```

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}
REMOTE_DEPLOY_DIR=${REMOTE_DEPLOY_DIR:-/opt/cloverdash-bot}

# Backend logs
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/backend && docker-compose logs -f"

# Bot logs  
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/telegram-bot && docker-compose logs -f"
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}
REMOTE_DEPLOY_DIR=${REMOTE_DEPLOY_DIR:-/opt/cloverdash-bot}

# Backend
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/backend && docker-compose restart"

# Bot
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/telegram-bot && docker-compose restart"
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–Ω–æ–≤–∞:
```bash
./deploy_all.sh
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è:
- **–ù–æ–≤—ã–π SECRET_KEY** –¥–ª—è JWT –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
- **Non-root –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **JWT Authentication** –¥–ª—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
- **Health monitoring** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **–†–∞–∑–¥–µ–ª—å–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥–∞–Ω–Ω—ã—Ö

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è PostgreSQL
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ OpenAI API –∫–ª—é—á–∏
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

## üõ† –û—Ç–ª–∞–¥–∫–∞

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Docker:
```bash
# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Docker –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
./test_docker_installation.sh

# –° custom –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
./test_docker_installation.sh -h your-server.com -u ubuntu
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –≤–µ—Ä—Å–∏—é Docker
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –≤–µ—Ä—Å–∏—é docker-compose  
- ‚úÖ –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å Docker daemon
- ‚úÖ –°–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Docker
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –æ–±—Ä–∞–∑—ã

### –ï—Å–ª–∏ Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}
REMOTE_DEPLOY_DIR=${REMOTE_DEPLOY_DIR:-/opt/cloverdash-bot}

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/backend && docker-compose logs"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/backend && docker-compose exec backend python -c \"
from services.app_database import get_app_database;
from services.data_database import get_data_database;
print('Testing connections...');
app_db = get_app_database();
data_db = get_data_database();
print('Connections OK')
\""
```

### –ï—Å–ª–∏ Bot –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}
REMOTE_DEPLOY_DIR=${REMOTE_DEPLOY_DIR:-/opt/cloverdash-bot}

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "cd $REMOTE_DEPLOY_DIR/telegram-bot && docker-compose logs"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Backend API
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "curl -s http://localhost:8000/api/v1/health"
```

### –ï—Å–ª–∏ SSH –∫–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª—é—á—É
chmod 600 $SSH_KEY_PATH

# –î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ ssh-agent
ssh-add $SSH_KEY_PATH

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST 'echo "Connection OK"'
```

### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ deploy.env
source deploy.env 2>/dev/null || true
SSH_KEY_PATH=${SSH_KEY_PATH:-~/.ssh/id_ed25519_do_cloverdash-bot}
REMOTE_USER=${REMOTE_USER:-root}
REMOTE_HOST=${REMOTE_HOST:-64.227.69.138}

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ app database
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "psql -h localhost -U app_user -d cloverdash_app"

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ data database
ssh -i $SSH_KEY_PATH $REMOTE_USER@$REMOTE_HOST \
  "psql -h localhost -U data_user -d cloverdash_data"
```

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```
${REMOTE_DEPLOY_DIR:-/opt/cloverdash-bot}/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ .env                    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ ...                     # –í—Å–µ —Ñ–∞–π–ª—ã backend
‚îÇ
‚îú‚îÄ‚îÄ telegram-bot/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ .env                    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ bot.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ ...                     # –í—Å–µ —Ñ–∞–π–ª—ã telegram-bot
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—É—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `deploy.env` —Ñ–∞–π–ª–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `REMOTE_DEPLOY_DIR`.

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —É –≤–∞—Å –±—É–¥–µ—Ç:

- üîó **Backend API**: `http://${REMOTE_HOST}:8000`
- üìö **API Docs**: `http://${REMOTE_HOST}:8000/docs`
- ü§ñ **Telegram Bot**: –†–∞–±–æ—Ç–∞–µ—Ç –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- üîê **JWT Authentication**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- üóÑÔ∏è **Database Integration**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –¥–≤—É–º PostgreSQL –±–∞–∑–∞–º
- üß† **AI Integration**: OpenAI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- üîÑ **Auto-restart**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö

**–í—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è**: 5-8 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–µ–∫–∞

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞**:
```bash
./deploy_all.sh
```

üéØ **Production Ready!** 